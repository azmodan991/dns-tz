# Объяснение настроек
Все созданные файлы описаны внутри себя через комментарии
1. ./www/html/index.php - основная страничка nginx, которая тягает информацию из бд
2. ./nginx/nginx.conf - основной файл конфигурации nginx
3. ./nginx/conf.d/default.conf - файл конфигрурации настроенной виртуального хоста nginx, который используется в проекте
4. ./init.sql - минимальная настройка и заполнение нашей бд для доказательства работы
5. ./start.sh - основной скрипт, который выполняет запуск сервисов 
6. ./Dockerfile - собственно Dockerfile, который будет билдить образ с LEMP-stack
7. ./docker-compose.yml - в проекте является больще вспомогательным, нежели необходимым

# Зачем docker-compose.yml
Все для "упрощенного запуска". При запуске через docker необходимо задавать параметры для volume, port, network, что выполняется наглядным yaml конфигом. Но в то же время можно и использовать лишь Dockerfile без Docker compose.

# Инструкция запуска
1. Если используется docker compose (рекомендованный вариант):
  1.1 В папке с docker-compose.yaml выполнить команду ```docker compose up --build```
2. Если использовать docker, необходимо выполнить последовательность команд
  2.1 ```docker network create lemp-net```
  2.2 В директории с Dockerfile - ```docker build -t lemp-stack .```
  2.3 ```docker run -d --name lemp-container --network lemp-net -p 80:80 -v $(pwd)/nginx:/etc/nginx -v $(pwd)/php-fpm.d:/etc/php-fpm.d -v $(pwd)/www:/var/www lemp-stack```

3. Для проверки работоспособности перейти в браузере или выполнить curl/wget (мб что-то еще) к:
  3.1 localhost - вывод двух строк из базы данных
  3.2 localhost/metrics - вывод метрик nginx

# Метрики nginx
Использовался стандартный модуль Nginx Stub Status, который отображает базовую информацию о текущем состоянии сервера. Я его никак не менял, как видно, потому пройдемся по тому, что он показывает из такого состояния.
1. Active connections -  текущее количество активных соединений с сервером (клиенты, подключенные в данный момент)
2. server accepts handled requests - три числовых показателя:
  2.1 общее количество принятых соединений
  2.2 количество успешно обработанных соединений (обычно совпадает с принятыми, если нет отказов)
  2.3 общее количество выполненных запросов. Это число может быть больше, чем количество соединений, потому что одно соединение может обрабатывать несколько запросов
3. Reading - количество соединений, где nginx читает запрос от клиента
4. Writing - количество соединений, в которых сервер отправляет ответ клиенту
5. Waiting - соединения, ожидающие новых запросов (они и не читаются, и не пишутся, а прост ждут кипэлайвов)

# Что можно поменять
1. Можно заменить bind mount всей папки на прикручивание конкретных файлов (например, default.conf). Сделано так, чтобы можно было менять все конфигурационные папки,  в моей голове это "профитней". Ну и так как я не разу не трогал пыху, то сначала проделал на хосте, после чего в режиме "не трогай, пока работает" закинул в проект фулл папки.
2. Ну и безопасностью тут не пахнет, креды открыты, доступ к мертрикам у всех и тд. 

# Pы.Sы
Если где-то не хватает объяснений, в любой момент можно уточнить, написав мне. Если где-то что-то не рассказал, значит посчитал это "очевидным"
